{% extends 'index.html' %}
{% block content %}
<div class="container mt-4">
      <h1 class="mt-4">Crear Orden</h1>
      <div class="card mb-4">
        <div class="card-header">
          <i class="fas fa-table me-1"></i>
          Nueva Orden
        </div>
        <div class="row">
          <div class="col-md-8">
            <div class="card-body">
              <h2>Carrito</h2>
              {% if items %}
                <table class="table responsive tableCart" id="datatablesSimple">
                  <thead>
                    <tr>
                      <th>Imagen</th>
                      <th>Producto</th>
                      <th>Cantidad</th>
                      <th>Precio</th>
                      <th>Subtotal</th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for it in items %}
                      <tr>
                        <td>
                          {% if it.product.image %}
                            <img src="{{ it.product.image }}" alt="{{ it.product.name }}" style="height:60px;" />
                          {% else %}
                            <img src="/static/img/recipe-1.jpg" style="height:60px;" />
                          {% endif %}
                        </td>
                        <td>{{ it.product.name }}</td>
                        <td>
                          <a href="{% url 'shop:cart_restar' it.product.id %}" class="btn btn-danger" id="btnMenos"><i class="fas fa-minus"></i></a>
                          {{ it.quantity }}
                          <a href="{% url 'shop:cart_sumar' it.product.id %}" class="btn btn-success" id="btnMas"><i class="fas fa-plus"></i></a>
                        </td>
                        <td>{{ it.product.price }}</td>
                        <td id="total">{{ it.line_total }}</td>
                        <td>
                          <a href="{% url 'shop:cart_remove' it.product.id %}" class="btn btn-sm btn-outline-danger">Eliminar</a>
                        </td>
                      </tr>
                    {% endfor %}
                  </tbody>
                </table>

                <div class="d-flex justify-content-between align-items-center">
                  <h4>Total: {{ total }}</h4>
                </div>
              {% else %}
                <p>El carrito está vacío.</p>
              {% endif %}
            </div>
          </div>
          <div class="col-md-4">
            <div class="card-body">
              <div class="container">
                <h2>Datos del cliente</h2>
                <form method="post" action="{% url 'shop:checkout' %}">
                  {% csrf_token %}
                  <div class="mb-3 mt-4">
                    <label for="nombre" class="form-label fw-bold">Nombre y apellido</label>
                    <input type="text" class="form-control border-primary" id="nombre" name="nombreApellido" placeholder="Ingrese su nombre y apellido" required />
                  </div>
                  <div class="mb-3">
                    <label for="telefono" class="form-label fw-bold">Telefono</label>
                    <input type="text" class="form-control border-primary" id="telefono" name="telefono" placeholder="Ingrese su numero de telefono" required />
                  </div>
                  <br />
                  <div class="mb-3 align-items-center">
                    <button type="submit" class="btn btn-primary"><i class="fas fa-shopping-cart"></i> Finalizar compra</button>
                    <a href="{% url 'Tienda:home' %}" class="btn btn-secondary"><i class="fas fa-store"></i> Ir a la tienda</a>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
{% endblock %}